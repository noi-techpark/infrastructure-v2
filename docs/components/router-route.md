<!--
SPDX-FileCopyrightText: NOI Techpark <digital@noi.bz.it>

SPDX-License-Identifier: CC0-1.0
-->

# Router Route

| From | To | Note |
| - | - | - |
| RabbitMQ `ready-q` queue ([Notifier](notifier.md)) | RabbitMQ `routed` exchange ([Transformers](transformer.md)) | If there are queues bounded to the RoutingKey generated by the **Notifier** |
| - | RabbitMQ `routed-dl` exchange | If there the RoutingKey generated by the **Notifier** is unroutable |

![router-route](../assets/router-route.svg)

**Router Route** is responsible for building the [Routing Key](../rabbitmq.md#routing-key) of a message after it has been written in the [Raw Data Table](../raw-data-table.md).

For the sake of the PoC, we decided that the routing key is generated from the `database` and the `collection` where the data has been inserted.

| Database | Collection | Routing Key |
| - | - | - |
| skidata | ortisei | skidata.ortisei | 
| skidata | skidata | skidata.skidata |

Even if the rule is quite trivial, we decided to create a dedicated route anyway to foresee any future logic which could be more complex.

The generated routing key is then used to inform the correct **Transformer(s)** about the newly inserted data.